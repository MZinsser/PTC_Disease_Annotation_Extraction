#The weakly connected components aka unionFind algo assigns connected nodes into partitions
#Here I'm writing in the partition that each node is assigned to as a property of that node
CALL algo.unionFind(null, 'is_annotated_in')
YIELD nodes AS Nodes, setCount AS NbrOfComponents, writeProperty AS PropertyName;

#Now create relationships between each of the nodes belonging to the same partition (easier to visualize this way)
match (d1:Disease)
with d1
match (d2:Disease)
where d2.someproperty = d1.someproperty and d1 <> d2
merge(d1)-[r:partitioned_with]-(d2)
